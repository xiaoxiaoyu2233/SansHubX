local SansHubESP = {}

function SansHubESP:AddESP(Child, Name, Color, Size, Title)
    local Billboard = Instance.new("BillboardGui", Child)
    local Text = Instance.new("TextLabel", Billboard)
    local DistanceText = Instance.new("TextLabel", Billboard) -- 添加距离文本标签
    local Highlight = Instance.new('Highlight', Child)
    local UIStroke = Instance.new("UIStroke", Text)
    Billboard.AlwaysOnTop = true
    Billboard.Size = UDim2.new(0, 400, 0, 100)
    Billboard.Adornee = Child
    Billboard.Name = Title
    Billboard.Active = true
    Text.AnchorPoint = Vector2.new(0.5, 0.5)
    Text.BackgroundTransparency = 1
    Text.BackgroundColor3 = Color3.new(0, 0, 0)
    Text.TextColor3 = Color
    Text.Font = "GothamSemibold"
    Text.TextSize = Size
    Text.Text = Name
    Text.TextTransparency = 0
    Text.Visible = true
    Text.Size = UDim2.new(1, 0, 0, 0)
    Text.Position = UDim2.new(0.5, 0, 0.7, -35)
    UIStroke.Thickness = 0.75
    Highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    Highlight.FillColor = Color
    Highlight.OutlineColor = Color
    Highlight.FillTransparency = 1
    Highlight.OutlineTransparency = 1
    Highlight.Name = Title
    
    -- 设置距离文本标签的属性
    DistanceText.AnchorPoint = Vector2.new(0.5, 0.5)
    DistanceText.BackgroundTransparency = 1
    DistanceText.BackgroundColor3 = Color3.new(0, 0, 0)
    DistanceText.TextColor3 = Color
    DistanceText.Font = "GothamSemibold"
    DistanceText.TextSize = Size
    DistanceText.Text = "[距离:]"
    DistanceText.TextTransparency = 0
    DistanceText.Visible = true
    DistanceText.Size = UDim2.new(1, 0, 0, 0)
    DistanceText.Position = UDim2.new(0.5, 0, 0.9, -35)
    
    task.wait(0.25)
    game:GetService('TweenService'):Create(Highlight, TweenInfo.new(1), {
        FillTransparency = 0.9,
        OutlineTransparency = 0
    }):Play()
    
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    
    task.spawn(function()
        while true do
            task.wait(0.1) -- 减少计算频率以提高性能
            if character and Child and Child.Parent then -- 确保Child存在且有Parent
                local distance = (character.HumanoidRootPart.Position - Child.Position).Magnitude
                DistanceText.Text = "[距离:] " .. math.floor(distance)
            else
                DistanceText.Text = "[距离:]"
            end
        end
    end)
end

function SansHubESP:Delete(name)
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == name then
            v:Destroy()
        end
    end
end

return SansHubESP
